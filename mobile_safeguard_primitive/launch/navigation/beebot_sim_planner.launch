<launch>
<!--
this launch file is used for testing the SBPL's AD* planner.
This file is dedicated to simulation with Gazebo. There will be
its sister launch files coming up to run beebot in the actual world.

Usage:

1. Launch beebot_2d_planner_node. It runs on ADStar and RSTAR
   algorithm. By default it runs on ADStar. If you need switch 
   to one of both planners, add
   <param name="planner_type" value="[desired_planner]"/> within
   the node tag.

2. Change the map_file tag to the desired map directory. If you load
   in the .world file with the wrong format, Gazebo will launch neither
   the robot nor the map.
-->

  <arg name="odom_in" default="/odometry/filtered"/>
  <arg name="pose_in" default="/robot_pose_ekf/odom_combined" />

  <param name="/use_sim_time" value="true" />
  
  <!-- fire up Gazebo and Rviz for simulation and visualization-->
  <include file="$(find simulation_tobot)/beebot_control/launch/beebot_control.launch">
     <arg name="world_file" value="$(find simulation_tobot)/maps/my_test_room_1.world" />
  </include>
  
   <!--launch gmapping-->
   <include file="$(find mobile_safeguard_primitive)/launch/gmapping.launch">
	   <arg name="scan_topic" value="/beebot/laser/scan" />
   </include>
<<<<<<< HEAD:mobile_safeguard_primitive/launch/navigation/beebot_2d_planner.launch
   
=======

  <!-- EKF filter for odometry -->
  <!-- Launch laser odometry -->
>>>>>>> 81562f9249cd6db5e9b7f1882a30ef4322c52abe:mobile_safeguard_primitive/launch/navigation/beebot_sim_planner.launch
  <node pkg="tf" type="static_transform_publisher" name="base_link_base_footprint_broadcaster" 
        args="0 0 -0.1685 0 0 0 /base_link /base_footprint 100"/>

  <!--<node pkg="tf" type="static_transform_publisher" name="odom_base_link_broadcaster" 
        args="0 0 0 0 0 0 /odom /base_link 100"/>--> 

  <!--<node pkg="tf" type="static_transform_publisher" name="map_scanmatcher_frame_broadcaster" 
        args="0 0 0 0 0 0 /map /scanmatcher_frame 100"/>-->
  <!--<node pkg="tf" type="static_transform_publisher" name="scanmatcher_frame_base_link_broadcaster" 
        args="0 0 0 0 0 0 /scanmatcher_frame /base_link 100"/>-->

  <!-- EKF filter for odometry -->
  <!-- Launch laser odometry -->
<!--
  <include file="$(find mobile_safeguard_primitive)/launch/navigation/odometries/laser_odometry.launch">
	  <arg name="scan_topic" value="/beebot/laser/scan"/>
  </include>  
-->  
  <!-- Launch visual odometry -->
<!--
  <include file="$(find mobile_safeguard_primitive)/launch/navigation/odometries/viso2_mono_odometry.launch">
	  <arg name="image_in" value="/beebot/camera/image_raw" />
	  <arg name="camera_info" value="/beebot/camera/camera_info" />
  </include>
-->
  <!-- Launch EKF filtered odometry. Published topic: /odometry/filtered -->
<!--
  <include file="$(find mobile_safeguard_primitive)/launch/navigation/odometries/ekf_filtered_odom.launch">
	  <arg name="visual_odom" value="/mono_odometer/odometry" />
<<<<<<< HEAD:mobile_safeguard_primitive/launch/navigation/beebot_2d_planner.launch
          <arg name="wheel_odom"  value="/beebot_diff_drive_controller/odom" />
          <arg name="odom_frame"  value="/odom" />
          <arg name="slam_odom"   value="/odom" />
  </include>
-->  
  <!-- amcl -->
<!--
  <include file="$(find mobile_safeguard_primitive)/launch/start_amcl.launch">
    <arg name="use_map_topic" value="true"/>
    <arg name="scan_topic" value="/beebot/laser/scan" />
  </include>
-->  
  <!-- MY PLANNER !! -->
  <!--<node pkg="mobile_safeguard_primitive" type="beebot_2d_planner_node" name="beebot_2d_planner_node">
	  <remap from="/initialpose" to="/amcl_pose" />
	  <remap from="/goal" to="/move_base_simple/goal" />
  </node>
-->  
  <!--<node pkg="mobile_safeguard_primitive" type="path2traj_converter" name="path2traj_converter"/>
-->
  <!-- Controller mode -->
  <!--<node pkg="riskrrt" type="controller" name="controller" output="screen">
    <remap from="/cmd_vel" to="/beebot_diff_drive_controller/cmd_vel" />
  </node>
-->
=======
          <arg name="wheel_odom" value="/beebot_diff_drive_controller/odom" />
          <arg name="odom_frame" value="odom" />
  </include>
  
  <!-- Publishing robot pose so that nav planner can use -->
  <node pkg="robot_pose_ekf" type="robot_pose_ekf" name="robot_pose_ekf">
    <param name="output_frame" value="odom"/>
    <param name="freq" value="10.0"/>
    <param name="sensor_timeout" value="1.0"/>
    <param name="odom_used" value="true"/>
    <param name="imu_used" value="false"/>
    <param name="vo_used" value="false"/>
    <param name="debug" value="false"/>
    <param name="self_diagnose" value="false"/>

    <remap from="/odom" to="$(arg odom_in)" />
  </node>
   
  <!-- MY PLANNER !! -->
  <include file="$(find mobile_safeguard_primitive)/launch/navigation/nav_planner/riskrrt_planner.launch">
  </include>
>>>>>>> 81562f9249cd6db5e9b7f1882a30ef4322c52abe:mobile_safeguard_primitive/launch/navigation/beebot_sim_planner.launch
</launch>
